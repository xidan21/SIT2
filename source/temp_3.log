
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R -- это свободное ПО, и оно поставляется безо всяких гарантий.
Вы вольны распространять его при соблюдении некоторых условий.
Введите 'license()' для получения более подробной информации.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Введите 'demo()' для запуска демонстрационных программ, 'help()' -- для
получения справки, 'help.start()' -- для доступа к справке через браузер.
Введите 'q()', чтобы выйти из R.

> #!/bin/R
> 
> 
> 
> 
> argv <- commandArgs(trailingOnly=T)
> 
> require("biomaRt")
> 
> mart <- useMart(biomart="ENSEMBL_MART_ENSEMBL", dataset=argv[1])
> 
> x <- read.csv("../source/total_snps.txt", header = F, sep = "\t")
> 
> 
> keys <- x[,1]
> 
> annotations <- getBM(
+ mart=mart,
+ attributes=c("ensembl_gene_id", "ensembl_transcript_id","external_gene_name","description"),
+ filter="ensembl_transcript_id",
+ values=keys,
+ uniqueRows=TRUE)
> 
> 
> match_index <- match(annotations[,2], keys)
> x <- x[match_index,]
> 
> y <- data.frame(x[,1], annotations,x[,2:ncol(x)])
> colnames(y)[1] <- "Transcript Id"
> colnames(y)[6] <- "Chromosome"
> colnames(y)[7] <- "SNV position"
> colnames(y)[8] <- "SNV"
> colnames(y)[9] <- "Gene Regions"
> 
> write.table(y,"../result/total_snps_annotated.txt", row.names = FALSE, col.names = T, quote=F, sep = "\t")
> 
> 
> 
